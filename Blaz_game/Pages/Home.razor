@using Blaz_game.Services
@using Player
@using Joueur = Joueur
@page "/"
@inject JoueurStateService JoueurStateService
@inject NavigationManager NavigationManager

<h1>Bienvenue sur le jeu</h1>
<p>Choisissez un personnage pour commencer :</p>

<select @onchange="OnCharacterSelected">
    <option value="">-- Sélectionnez --</option>
    <option value="Voleur">Voleur</option>
    <option value="Barbare">Barbare</option>
    <option value="Guerrier">Guerrier</option>
</select>

<button @onclick="StartGame" disabled="@(!canStartGame)">Démarrer le jeu</button>

<p>@message</p>

@code {
    private string selectedCharacter = "";
    private bool canStartGame = false;
    private string message = "";

    private void OnCharacterSelected(ChangeEventArgs e)
    {
        selectedCharacter = e.Value.ToString();
        canStartGame = !string.IsNullOrEmpty(selectedCharacter);

        message = canStartGame
            ? $"Vous avez sélectionné {selectedCharacter}. Cliquez sur 'Démarrer le jeu'."
            : "Veuillez choisir un personnage.";
    }

    private void StartGame()
    {
        if (string.IsNullOrEmpty(selectedCharacter))
        {
            return;
        }

        switch (selectedCharacter)
        {
            case "Voleur":
                JoueurStateService.SetJoueur(new Joueur());
                break;
            case "Barbare":
                JoueurStateService.SetJoueur(new Joueur());
                break;
            case "Guerrier":
                JoueurStateService.SetJoueur(new Joueur());
                break;
        }

        NavigationManager.NavigateTo("/carte");
    }
}